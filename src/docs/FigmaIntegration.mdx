import { Meta } from '@storybook/addon-docs/blocks';

<Meta title="Documentation/Figma Integration" />

# Figma Integration Guide

Two-way integration between [Figma Library](https://www.figma.com/design/S8zFdcOjt4qN4PrwntuCdt/Fanvue-Library) and Storybook.

## Quick Start

### Step 1: Add Design Tab to Stories

**Shows Figma designs in Storybook** (Developer → Design)

We use `@storybook/addon-designs` to embed Figma designs directly in Storybook. Add the `design` parameter to your story:

```tsx
import type { Meta, StoryObj } from "@storybook/react";
import { ComponentName } from "./ComponentName";

const meta = {
  title: "Components/ComponentName",
  component: ComponentName,
  parameters: {
    layout: "centered",
    design: {
      type: "figma",
      url: "https://www.figma.com/design/S8zFdcOjt4qN4PrwntuCdt/Fanvue-Library?node-id=123-456",
    },
  },
  tags: ["autodocs"],
} satisfies Meta<typeof ComponentName>;

export default meta;
```

**Get Figma URL:**
1. In Figma: Right-click component → "Copy link"
2. Paste URL into the `design.url` parameter
3. View in Storybook: Open story → Click "Design" tab

### Step 2: Link to Storybook Connect (Manual)

**Shows Storybook stories in Figma Dev Mode** (Design → Developer)

After implementing and deploying your component:

1. **Get Storybook URL:**
   - CI automatically publishes Storybook on every PR/push to main
   - Find the Chromatic URL in PR comments or from the [Chromatic dashboard](https://www.chromatic.com/)

2. **Install Figma Plugin:**
   - In Figma: `Shift+I` → Search for **"Storybook Connect"**
   - Or install from: https://www.figma.com/community/plugin/1056265616080331589

3. **Link Components:**
   - Select a component in Figma
   - Open Storybook Connect plugin (`Shift+I`)
   - Paste your Storybook URL
   - Find and link the matching story

## Design Tokens

Design tokens from Figma are automatically transformed into CSS variables for use in components.

### File Structure

- `src/styles/styleTokens.json` - Exported from Figma (source of truth)
- `src/styles/theme.css` - Auto-generated CSS variables (do not edit manually)
- `src/styles/buildStyles.js` - Transformation script using Style Dictionary

### Updating Tokens from Figma

**Prerequisites:**
- Edit permissions to the [Figma Library](https://www.figma.com/design/S8zFdcOjt4qN4PrwntuCdt/Fanvue-Library)
- Install [Design Tokens Plugin](https://www.figma.com/community/plugin/888356646278934516/design-tokens)

**Step 1: Export from Figma**

1. Open Figma Library
2. Run plugin: `Plugins > Design Tokens`
3. Export as JSON
4. Save to `src/styles/styleTokens.json`

**Step 2: Generate CSS**

```bash
pnpm build:dictionary
```

This auto-generates `src/styles/theme.css` (do not edit manually):
- `:root` - Light mode
- `.dark` - Dark mode
- `@theme` - Tailwind mappings

## Resources

- [Figma Library](https://www.figma.com/design/S8zFdcOjt4qN4PrwntuCdt/Fanvue-Library)
- [Storybook Addon Designs](https://storybook.js.org/addons/@storybook/addon-designs) - Design tab in Storybook
- [Storybook Connect Plugin](https://www.figma.com/community/plugin/1056265616080331589) - Link stories in Figma
- [Style Dictionary](https://amzn.github.io/style-dictionary/)
